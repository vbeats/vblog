<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" type="image/x-icon" sizes="128x128" href="/favicon.ico"><title>Flink | Vbeats</title><meta name="description" content="Good Good Study ğŸ‘ Day Day UP">
    <link rel="preload" href="/assets/js/runtime~app.6686f77d.js" as="script"><link rel="preload" href="/assets/css/styles.c3e81397.css" as="style"><link rel="preload" href="/assets/js/7.3d9f59d0.js" as="script"><link rel="preload" href="/assets/js/app.42261b4c.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.c3e81397.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">Vbeats</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="é¦–é¡µ"><!--[--><!--]--> é¦–é¡µ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/base/" class="nav-link" aria-label="æ‚è®°"><!--[--><!--]--> æ‚è®° <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/backend/" class="nav-link" aria-label="åç«¯"><!--[--><!--]--> åç«¯ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/frontend/" class="nav-link" aria-label="å‰ç«¯ğŸ‘½"><!--[--><!--]--> å‰ç«¯ğŸ‘½ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/cloud/" class="nav-link" aria-label="äº‘â˜ï¸"><!--[--><!--]--> äº‘â˜ï¸ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/arch/" class="nav-link" aria-label="æ¶æ„ğŸ¥"><!--[--><!--]--> æ¶æ„ğŸ¥ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/data/" class="nav-link router-link-active" aria-label="æ•°æ®å¤„ç†"><!--[--><!--]--> æ•°æ®å¤„ç† <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/datav/" class="nav-link" aria-label="æ•°æ®å¯è§†åŒ–"><!--[--><!--]--> æ•°æ®å¯è§†åŒ– <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å…¶å®ƒ"><span class="title">å…¶å®ƒ</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="å…¶å®ƒ"><span class="title">å…¶å®ƒ</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/note/" class="nav-link" aria-label="é…ç½®"><!--[--><!--]--> é…ç½® <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/" class="nav-link" aria-label="å…¶å®ƒèµ„æº"><!--[--><!--]--> å…¶å®ƒèµ„æº <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/boot-vue" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="æŒ‰ä¸‹ / æœç´¢" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="é¦–é¡µ"><!--[--><!--]--> é¦–é¡µ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/base/" class="nav-link" aria-label="æ‚è®°"><!--[--><!--]--> æ‚è®° <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/backend/" class="nav-link" aria-label="åç«¯"><!--[--><!--]--> åç«¯ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/frontend/" class="nav-link" aria-label="å‰ç«¯ğŸ‘½"><!--[--><!--]--> å‰ç«¯ğŸ‘½ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/cloud/" class="nav-link" aria-label="äº‘â˜ï¸"><!--[--><!--]--> äº‘â˜ï¸ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/arch/" class="nav-link" aria-label="æ¶æ„ğŸ¥"><!--[--><!--]--> æ¶æ„ğŸ¥ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/data/" class="nav-link router-link-active" aria-label="æ•°æ®å¤„ç†"><!--[--><!--]--> æ•°æ®å¤„ç† <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/datav/" class="nav-link" aria-label="æ•°æ®å¯è§†åŒ–"><!--[--><!--]--> æ•°æ®å¯è§†åŒ– <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å…¶å®ƒ"><span class="title">å…¶å®ƒ</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="å…¶å®ƒ"><span class="title">å…¶å®ƒ</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/note/" class="nav-link" aria-label="é…ç½®"><!--[--><!--]--> é…ç½® <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/" class="nav-link" aria-label="å…¶å®ƒèµ„æº"><!--[--><!--]--> å…¶å®ƒèµ„æº <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/boot-vue" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">åŸºç¡€</p><ul class=""><li><!--[--><a href="/data/base/mysql.html" class="nav-link sidebar-item" aria-label="MySQL â˜¢ï¸"><!--[--><!--]--> MySQL â˜¢ï¸ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/redis.html" class="nav-link sidebar-item" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/elk.html" class="nav-link sidebar-item" aria-label="ELK"><!--[--><!--]--> ELK <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/hadoop.html" class="nav-link sidebar-item" aria-label="Hadoop åŸºç¡€"><!--[--><!--]--> Hadoop åŸºç¡€ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/hdfs.html" class="nav-link sidebar-item" aria-label="HDFS"><!--[--><!--]--> HDFS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/mapreduce.html" class="nav-link sidebar-item" aria-label="MapReduce"><!--[--><!--]--> MapReduce <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="Flink"><!--[--><!--]--> Flink <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/data/base/flink.html#dateset" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="DateSet"><!--[--><!--]--> DateSet <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#datestream" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="DateStream"><!--[--><!--]--> DateStream <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#job-manager" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="job manager"><!--[--><!--]--> job manager <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#task-manager" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="task manager"><!--[--><!--]--> task manager <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#redource-manager" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="redource manager"><!--[--><!--]--> redource manager <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#dispatcher" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="dispatcher"><!--[--><!--]--> dispatcher <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#parallelism" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Parallelism"><!--[--><!--]--> Parallelism <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#dataflow" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="dataflow"><!--[--><!--]--> dataflow <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#ä»»åŠ¡é“¾" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ä»»åŠ¡é“¾"><!--[--><!--]--> ä»»åŠ¡é“¾ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#api" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="API"><!--[--><!--]--> API <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#window" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="window"><!--[--><!--]--> window <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#æ—¶é—´è¯­ä¹‰" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ—¶é—´è¯­ä¹‰"><!--[--><!--]--> æ—¶é—´è¯­ä¹‰ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#watermark" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="watermark"><!--[--><!--]--> watermark <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#çŠ¶æ€ç®¡ç†" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="çŠ¶æ€ç®¡ç†"><!--[--><!--]--> çŠ¶æ€ç®¡ç† <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#process-api" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="process api"><!--[--><!--]--> process api <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#å®¹é”™" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="å®¹é”™"><!--[--><!--]--> å®¹é”™ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#table-api-sql" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="table api(sql)"><!--[--><!--]--> table api(sql) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/data/base/flink.html#cep" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="cep"><!--[--><!--]--> cep <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/data/base/kafka.html" class="nav-link sidebar-item" aria-label="Kafka ğŸ’¥"><!--[--><!--]--> Kafka ğŸ’¥ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/mongo.html" class="nav-link sidebar-item" aria-label="Mongo"><!--[--><!--]--> Mongo <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/rabbit.html" class="nav-link sidebar-item" aria-label="RabbitMQ"><!--[--><!--]--> RabbitMQ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/rocket.html" class="nav-link sidebar-item" aria-label="RocketMQ ğŸš€"><!--[--><!--]--> RocketMQ ğŸš€ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/data/base/zookeeper.html" class="nav-link sidebar-item" aria-label="Zookeeper"><!--[--><!--]--> Zookeeper <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">æ–‡ç« </p><ul class=""><li><!--[--><a href="/data/article/.md" class="nav-link sidebar-item" aria-label="/data/article/.md"><!--[--><!--]--> /data/article/.md <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="flink" tabindex="-1"><a class="header-anchor" href="#flink" aria-hidden="true">#</a> Flink</h1><blockquote><p>äº‹ä»¶é©±åŠ¨ é«˜åå ä½å»¶è¿Ÿ æ—¶é—´æœ‰åº</p></blockquote><h2 id="dateset" tabindex="-1"><a class="header-anchor" href="#dateset" aria-hidden="true">#</a> DateSet</h2><p><code>ç¦»çº¿æ•°æ®æ‰¹å¤„ç†</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutionEnvironment</span> env <span class="token operator">=</span> <span class="token class-name">ExecutionEnvironment</span><span class="token punctuation">.</span><span class="token function">getExecutionEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">DataSource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> dataSource <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">readTextFile</span><span class="token punctuation">(</span><span class="token string">&quot;D:\\Codes\\flink-demo\\src\\main\\resources\\data.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">AggregateOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple2</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> operator <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">xx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operator<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> xx <span class="token keyword">implements</span> <span class="token class-name">FlatMapFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Tuple2</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token class-name">Collector</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple2</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> collector<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> strings <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> string <span class="token operator">:</span> strings<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                collector<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Tuple2</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// (xx,1)</span>
<span class="token comment">// (oo,1)</span>
<span class="token comment">// (uu,1)</span>
<span class="token comment">// (kk,2)</span>
<span class="token comment">// (xxx,1)</span>
<span class="token comment">// (world,2)</span>
<span class="token comment">// (yy,1)</span>
<span class="token comment">// (vv,1)</span>
<span class="token comment">// (hello,4)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>java å°‘ç”¨<code>lambda</code> ,ä¼šå¯¼è‡´ flink è‡ªåŠ¨ç±»å‹æ¨æ–­å¼‚å¸¸</p><h2 id="datestream" tabindex="-1"><a class="header-anchor" href="#datestream" aria-hidden="true">#</a> DateStream</h2><p><code>æµå¼æ•°æ®</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>       <span class="token class-name">StreamExecutionEnvironment</span> env <span class="token operator">=</span> <span class="token class-name">StreamExecutionEnvironment</span><span class="token punctuation">.</span><span class="token function">getExecutionEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// env.setParallelism(1);</span>
        <span class="token class-name">DataStreamSource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> dataSource <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">readTextFile</span><span class="token punctuation">(</span><span class="token string">&quot;D:\\Codes\\flink-demo\\src\\main\\resources\\data.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">SingleOutputStreamOperator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple2</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> operator <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">xx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> t<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operator<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        env<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3&gt; (kk,1)</span>
<span class="token comment">// 4&gt; (hello,1)</span>
<span class="token comment">// 1&gt; (xx,1)</span>
<span class="token comment">// 4&gt; (yy,1)</span>
<span class="token comment">// 8&gt; (vv,1)</span>
<span class="token comment">// 8&gt; (xxx,1)</span>
<span class="token comment">// 3&gt; (uu,1)</span>
<span class="token comment">// 10&gt; (oo,1)</span>
<span class="token comment">// 3&gt; (kk,2)</span>
<span class="token comment">// 7&gt; (world,1)</span>
<span class="token comment">// 4&gt; (hello,2)</span>
<span class="token comment">// 7&gt; (world,2)</span>
<span class="token comment">// 4&gt; (hello,3)</span>
<span class="token comment">// 4&gt; (hello,4)</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="job-manager" tabindex="-1"><a class="header-anchor" href="#job-manager" aria-hidden="true">#</a> job manager</h2><p>ä½œä¸šç®¡ç†: ä½œä¸šå›¾ é€»è¾‘æ•°æ®æµå›¾ æ‰€æœ‰çš„ jar èµ„æº</p><p>å‘<code>resource manager</code>ç”³è¯·èµ„æº check points æ£€æŸ¥</p><h2 id="task-manager" tabindex="-1"><a class="header-anchor" href="#task-manager" aria-hidden="true">#</a> task manager</h2><p>å·¥ä½œè¿›ç¨‹(jvm è¿›ç¨‹): åˆ†é… <code>slots</code> æ‰§è¡Œä»»åŠ¡</p><h2 id="redource-manager" tabindex="-1"><a class="header-anchor" href="#redource-manager" aria-hidden="true">#</a> redource manager</h2><p>ç®¡ç† task manager èµ„æº<code>slots</code></p><h2 id="dispatcher" tabindex="-1"><a class="header-anchor" href="#dispatcher" aria-hidden="true">#</a> dispatcher</h2><p><code>web ui</code> ä½œä¸š/ä»»åŠ¡ç®¡ç†æ¥å£</p><p>åº”ç”¨--&gt;dispatcher--&gt;æäº¤ç»™ jobmanager---&gt;å‘ resource manager ç”³è¯·èµ„æº--&gt;äº¤ç»™ task manager å¤„ç†</p><h2 id="parallelism" tabindex="-1"><a class="header-anchor" href="#parallelism" aria-hidden="true">#</a> Parallelism</h2><p><code>å¹¶è¡Œåº¦</code> å¹¶è¡Œå­ä»»åŠ¡ä¸ªæ•°, ä¸åŒå­ä»»åŠ¡å¯ä»¥åœ¨åŒä¸€ä¸ª slot æ‰§è¡Œ, å¿…é¡»æ˜¯æœ‰å‰åæ‰§è¡Œé¡ºåºçš„</p><p>åŒæ—¶æ‰§è¡Œçš„å­ä»»åŠ¡å¿…é¡»åˆ†é…åœ¨ä¸åŒçš„ slot</p><p><code>slot</code>é—´å†…å­˜èµ„æºäº’ç›¸éš”ç¦»</p><p><code>slotSharingGroup()</code> ä¸åŒç»„çš„è¦åˆ†é…ä¸åŒçš„ slot</p><h2 id="dataflow" tabindex="-1"><a class="header-anchor" href="#dataflow" aria-hidden="true">#</a> dataflow</h2><p>source--&gt;transformation--&gt;sink</p><h2 id="ä»»åŠ¡é“¾" tabindex="-1"><a class="header-anchor" href="#ä»»åŠ¡é“¾" aria-hidden="true">#</a> ä»»åŠ¡é“¾</h2><p>å¹¶è¡Œåº¦ç›¸åŒçš„ one-to-one åˆå¹¶</p><h2 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h2><p><code>createLocalEnvironment</code> <code>createRemoteEnvironment</code> <code>getExecutionEnvironment</code></p><ul><li><p>data source : <code>collection</code> <code>file</code> <code>csv</code> <code>kafka</code> <code>socket</code> .....</p><p><code>addSource(new FlinkKafkaConsumer&lt;String&gt;(&quot;topic&quot;,new SimpleStringSchema(),kafkaProperties))</code></p></li><li><p>transform: <code>flatmap</code> <code>map</code> <code>filter</code> <code>keyBy</code>åˆ†ç»„ èšåˆ</p><p><code>rich function</code> : å¯ä»¥è·å–åˆ°è¿è¡Œä¸Šä¸‹æ–‡</p><p><code>max</code> ä¸ <code>maxBy</code>: max åªæ›´æ–°èšåˆå­—æ®µå€¼,å…¶å®ƒå±æ€§å€¼ä¸å˜, maxBy æ•´ä¸ªå¯¹è±¡éƒ½ä¼šæ›´æ–°</p><p><code>reduce</code>: <code>T reduce(T v1,T v2)</code> å‰åçŠ¶æ€æ¯”è¾ƒ</p><p><code>SplitStream</code>: <code>split</code> <code>select</code> åˆ†å‰²æˆå¤šä¸ªæ•°æ®æµåˆ†ç¦»å¤„ç†</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SplitStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">People</span><span class="token punctuation">&gt;</span></span> splitStream <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MapFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">People</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token annotation punctuation">@Override</span>
          <span class="token keyword">public</span> <span class="token class-name">People</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token class-name">People</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputSelector</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">People</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// splitå¯ä»¥å°†ä¸€ä¸ªæµï¼Œé€šè¿‡æ‰“Tagçš„æ–¹å¼ï¼Œsplitæˆå¤šä¸ªæµ</span>
          <span class="token annotation punctuation">@Override</span>
          <span class="token keyword">public</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token class-name">People</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;male&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;male&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                  list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;female&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token keyword">return</span> list<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// SplitStreamæµ é€šè¿‡select(&quot;tag&quot;)è·å–DataStreamæµ</span>
      <span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">People</span><span class="token punctuation">&gt;</span></span> male <span class="token operator">=</span> splitStream<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;male&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      male<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;male:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">People</span><span class="token punctuation">&gt;</span></span> female <span class="token operator">=</span> splitStream<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;female&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      female<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;female:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><code>Connect</code> <code>CoMap</code>: åˆå¹¶ä¸¤ä¸ª dataStream, ç±»å‹å¯ä»¥ä¸åŒ <code>union</code>å¯ä»¥åˆå¹¶å¤šä¸ªæ•°æ®æµ,æ•°æ®ç±»å‹è¦ç›¸åŒ</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ConnectedStreams</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> connected <span class="token operator">=</span> first<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">CoMapFunction</span><span class="token punctuation">[</span>IN1<span class="token punctuation">,</span> IN2<span class="token punctuation">,</span> OUT<span class="token punctuation">]</span>

<span class="token class-name">CoFlatMapFunction</span><span class="token punctuation">[</span>IN1<span class="token punctuation">,</span> IN2<span class="token punctuation">,</span> OUT<span class="token punctuation">]</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p>sink</p><p><code>addSink</code>: è®¡ç®—ç»“æœè¾“å‡º</p></li></ul><h2 id="window" tabindex="-1"><a class="header-anchor" href="#window" aria-hidden="true">#</a> window</h2><p>æ— é™æµæ•°æ®åˆ‡å‰²ä¸ºæœ‰é™æµ, åˆ†å‘åˆ°æœ‰é™å¤§å°<code>bucket</code>ä¸­</p><p><code>time window</code>: æ»šåŠ¨<code>tumbling</code> æ»‘åŠ¨<code>sliding</code> ä¼šè¯<code>session</code>:timeout æ—¶é—´é—´éš™,æ²¡æœ‰æ–°æ•°æ®å¼€å§‹æ–°çª—å£</p><p><code>count window</code>: æ»šåŠ¨ æ»‘åŠ¨</p><p><code>window size</code> <code>slide size</code> æ»‘åŠ¨çª—å£æ•°æ®ä¼šé‡å </p><p>ä½¿ç”¨: <code>keyBy</code>--&gt;<code>timewindow()</code>--&gt;<code>èšåˆ</code> çª—å£ç»“æŸå<code>state</code>ç»“æœè¾“å‡º</p><p><code>å¢é‡èšåˆ</code></p><p><code>å…¨çª—å£å‡½æ•°</code>:<code>bucket</code>æ”¶é›†æ•°æ®,è®¡ç®—çš„æ—¶å€™å†éå†æ•°æ® <code>apply(WindowFunction)</code></p><p><code>triger</code>: è§¦å‘å™¨, è§¦å‘ window å…³é—­ è§¦å‘ç»“æœè®¡ç®—è¾“å‡º</p><p><code>evitor</code>: ç§»é™¤æŸäº›æ•°æ® <code>allowedLateness</code>: å…è®¸å»¶è¿Ÿæ—¶é—´(çª—å£å»¶è¿Ÿå…³é—­)</p><p><code>sideOutPutLateData</code>: è¿Ÿåˆ°æ•°æ®æ‰”åˆ° side out å¦ä¸€ä¸ªæ•°æ®æµ</p><h2 id="æ—¶é—´è¯­ä¹‰" tabindex="-1"><a class="header-anchor" href="#æ—¶é—´è¯­ä¹‰" aria-hidden="true">#</a> æ—¶é—´è¯­ä¹‰</h2><ul><li><p>event time : äº‹ä»¶åˆ›å»ºæ—¶é—´</p></li><li><p>ingestion time: æ•°æ®è¿›å…¥ flink çš„æ—¶é—´</p></li><li><p>process time: å¤„ç†æ•°æ®çš„æ—¶é—´ (é»˜è®¤)</p><p><code>env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime)</code> : åŒæ—¶æŒ‡å®šæ•°æ®å“ªä¸ªå­—æ®µä»£è¡¨ <code>event time</code></p></li></ul><h2 id="watermark" tabindex="-1"><a class="header-anchor" href="#watermark" aria-hidden="true">#</a> watermark</h2><p>çŸ­æ—¶é—´å¤§é‡ä¹±åºæ•°æ®, å»¶è¿Ÿçª—å£å…³é—­æ—¶é—´</p><p><code>watermark</code>æ˜¯ä¸€æ¡ç‰¹æ®Šçš„æ•°æ®è®°å½•<code>StreamElement</code></p><p>å¿…é¡»å•è°ƒé€’å¢, ä¸æ•°æ®çš„æ—¶é—´æˆ³ç›¸å…³</p><p>ä¸Šæ¸¸ä»»åŠ¡å‘ä¸‹å¹¿æ’­<code>watermark</code>æ—¶é—´, ä¸‹æ¸¸ä»»åŠ¡æŒ‰æœ€å°æ—¶é—´æˆ³æ¨è¿›äº‹ä»¶æ—¶é—´</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// æå–æ—¶é—´æˆ³   ç”Ÿæˆwatermark</span>
dataStream<span class="token punctuation">.</span><span class="token function">assignTimestampsAndWatermarks</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoundedOutOfOrdernessTimestampExtractor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>watermarkå»¶æ—¶æ—¶é—´<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="çŠ¶æ€ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#çŠ¶æ€ç®¡ç†" aria-hidden="true">#</a> çŠ¶æ€ç®¡ç†</h2><p>state ä¸èƒ½è·¨ä»»åŠ¡è¯»å–</p><ul><li><p>operator state</p><p><code>mapFunction</code> å±€éƒ¨å˜é‡</p><p><code>implements ListCheckPoint&lt;&gt;</code> : <code>snapsotState</code> <code>restoreState</code> å­˜å‚¨/æ¢å¤ state çŠ¶æ€</p></li><li><p>keyed state</p><p><code>richMapFunction</code></p><p>å£°æ˜çŠ¶æ€: open æ–¹æ³•å†…<code>getRuntimeContent().getState(new ValueStateDescriptor&lt;&gt;(&quot;&quot;,xxx.class))</code></p><p>è¯»å– state: <code>xxState.value()</code> æ›´æ–° state: <code>xxState.update(v)</code></p><p>å…¶å®ƒ state: <code>listState</code> <code>mapState</code> <code>reducingState</code>ç­‰èšåˆ state</p></li><li><p>state backends</p><p>æœ¬åœ°çŠ¶æ€ç®¡ç† state å­˜å‚¨</p><p><code>memory</code> <code>fs</code> <code>rocksDB</code></p></li></ul><h2 id="process-api" tabindex="-1"><a class="header-anchor" href="#process-api" aria-hidden="true">#</a> process api</h2><p><code>processFunction</code> <code>keyedProcessFuction</code> <code>coProcessFunction</code> <code>processJoinFunction</code> <code>broadcastProcessFunction</code> <code>processWindowFunction</code> <code>keyedBroadcastProcessFunction</code> <code>processAllWindowFunction</code></p><p><code>process</code>æ³¨å†Œå®šæ—¶å™¨</p><h2 id="å®¹é”™" tabindex="-1"><a class="header-anchor" href="#å®¹é”™" aria-hidden="true">#</a> å®¹é”™</h2><pre><code>`checkpoints` `savepoints`
</code></pre><h2 id="table-api-sql" tabindex="-1"><a class="header-anchor" href="#table-api-sql" aria-hidden="true">#</a> table api(sql)</h2><pre><code>`StreamTableEnvironment.create(env,settings)`
</code></pre><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Table</span> t<span class="token operator">=</span>tableEnv<span class="token punctuation">.</span><span class="token function">fromDataStream</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span><span class="token punctuation">;</span>
t<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;id,name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;id=10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// sql</span>
tableEnv<span class="token punctuation">.</span><span class="token function">createTemporaryView</span><span class="token punctuation">(</span><span class="token string">&quot;xxxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Table</span> ts<span class="token operator">=</span>tableEnv<span class="token punctuation">.</span><span class="token function">sqlQuery</span><span class="token punctuation">(</span><span class="token string">&quot;select id from xxx where ....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

tableEnv<span class="token punctuation">.</span><span class="token function">toAppendStream</span><span class="token punctuation">(</span>ts<span class="token punctuation">,</span><span class="token class-name">Row</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// -------------------</span>
tableEnv<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createTemporaryTable</span><span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


rs<span class="token punctuation">.</span><span class="token function">insertInto</span><span class="token punctuation">(</span><span class="token string">&quot;xxxTable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>Table</code>--&gt;<code>Catalog</code>--&gt;<code>database</code>--&gt;<code>object</code></p><ul><li>åˆ›å»ºè¡¨</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>tableEnv<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withFormat</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment">// æ•°æ®æ ¼å¼åŒ–/è§£æ</span>
        <span class="token punctuation">.</span><span class="token function">wifhSchema</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment">//è¡¨ç»“æ„</span>
        <span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span><span class="token class-name">DataTypes</span><span class="token punctuation">.</span><span class="token function">STRING</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">createTemporaryTable</span><span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span> <span class="token comment">// ä¸´æ—¶è¡¨ è¾“å…¥/è¾“å‡º</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>æŸ¥è¯¢</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// èšåˆ</span>
t<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;id, id.count as count, age.avg as avg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tableEnv<span class="token punctuation">.</span><span class="token function">sqlQuery</span><span class="token punctuation">(</span><span class="token string">&quot;select id,count(id) from xxx group by id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><p>è¾“å‡º</p><p>å¤–éƒ¨è¾“å‡ºæ—¶æ¨¡å¼<code>UpdateMode</code>:<code>append</code> <code>retract</code> <code>upsert</code></p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>rs<span class="token punctuation">.</span><span class="token function">insertInto</span><span class="token punctuation">(</span><span class="token string">&quot;xxxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// èšåˆç±»æ•°æ®éœ€è¦æ›´æ–°æ¨¡å¼ elasticsearch mysql redisæ”¯æŒ</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><p>table è½¬ dataStream: åªèƒ½<code>append</code> <code>retract</code></p></li><li><p>æ—¶é—´</p><p>å¤„ç†æ—¶é—´: å¢åŠ å­—æ®µ<code>.proctime</code></p><p>äº‹ä»¶æ—¶é—´: åŸæœ‰å­—æ®µ<code>.rowtime</code></p></li><li><p>window</p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>t<span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span>xxWindow as <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// windowåˆ«å</span>
    <span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;w, id&quot;</span><span class="token punctuation">)</span> <span class="token comment">// åˆ†ç»„è¦æŒ‡å®šwindow</span>
    <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;id,id.count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token class-name">Tumble</span><span class="token punctuation">.</span><span class="token function">over</span><span class="token punctuation">(</span><span class="token string">&quot;10.minutes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token string">&quot;5.minutes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;rowtime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ»šåŠ¨çª—å£ tumble</span>
<span class="token comment">// æ»‘åŠ¨çª—å£ hop</span>
<span class="token comment">// sessionçª—å£ session</span>

<span class="token comment">// -----------over window</span>
t<span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span>xxOverWindow as <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;id,id.count over w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token class-name">Over</span><span class="token punctuation">.</span><span class="token function">partitionBy</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">&quot;proctime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">preceding</span><span class="token punctuation">(</span>UNBOUNDED_RANGE<span class="token operator">/</span>ROW<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// æ— ç•Œover window</span>
<span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token class-name">Over</span><span class="token punctuation">.</span><span class="token function">partitionBy</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">&quot;proctime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">preceding</span><span class="token punctuation">(</span><span class="token string">&quot;1.minutes&quot;</span><span class="token operator">/</span><span class="token string">&quot;10.rows&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// æœ‰æ— ç•Œover window</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li><p>function å‡½æ•°</p><p><code>å†…ç½®å‡½æ•°</code></p><p><code>è‡ªå®šä¹‰å‡½æ•°</code>: env å…ˆæ³¨å†Œ function</p><pre><code>  1. `æ ‡é‡å‡½æ•°scalarFunction` å¿…é¡»æœ‰`public xxx eval()`æ–¹æ³• åªè¾“å‡ºå•ä¸ªå€¼
  2. `è¡¨å‡½æ•°TableFunction` å¿…é¡»æœ‰`public void eval()`æ–¹æ³• å¯ä»¥è¾“å‡ºå¤šè¡Œ
  3. `èšåˆå‡½æ•°aggregateFunction` å¤šæ¡è¾“å…¥ åˆ†ç»„èšåˆåè¾“å‡ºä¸€ä¸ªç»“æœ `createAcumulator()` `accumulate()` `getValue()`
  4. `è¡¨èšåˆå‡½æ•°tableAggregateFunction` èšåˆè¾“å‡ºå¤šè¡Œå¤šåˆ—ç»“æœ `createAcumulator()` `accumulate()` `emitValue()`
</code></pre></li></ul><h2 id="cep" tabindex="-1"><a class="header-anchor" href="#cep" aria-hidden="true">#</a> cep</h2><p><code>å¤æ‚äº‹ä»¶å¤„ç†</code>: è¾“å…¥--&gt;å¤„ç†(è§„åˆ™åŒ¹é…)--&gt;è¾“å‡ºç¬¦åˆè§„åˆ™çš„äº‹ä»¶</p><p><code>Pattern</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subtype</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">followedBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>ä¸ªä½“æ¨¡å¼</li></ul><p><code>start.times(2,4).optional</code>: optional å¯é€‰ 0 æ¬¡ <code>.greedy</code>å°½å¯èƒ½å¤šçš„é‡å¤åŒ¹é… <code>.onemore</code>ä¸€æ¬¡æˆ–å¤šæ¬¡ <code>start.timesOrMore(2).optional.greedy</code>: 0 æ¬¡ 2 æ¬¡æˆ–å¤šæ¬¡, å°½å¯èƒ½å¤šçš„åŒ¹é… <code>.consecutive</code> times ä¸¥æ ¼ç›¸é‚»</p><p>æ¡ä»¶: <code>where</code> <code>or</code> <code>until</code></p><ul><li><p>æ¨¡å¼åºåˆ—</p><p>å¿…é¡»ä»¥<code>begin</code>å¼€å§‹</p><p><code>notNext</code>: æŸä¸ªäº‹ä»¶ä¸è¦è¿‘é‚»å‰ä¸€ä¸ªäº‹ä»¶</p><p><code>notFollowedBy</code>: æŸä¸ªäº‹ä»¶ä¸è¦åœ¨ä¸¤ä¸ªäº‹ä»¶é—´å‘ç”Ÿ</p><p>å¯ä»¥æŒ‡å®šæ—¶é—´èŒƒå›´ <code>next.withIn(3s)</code></p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">PatternStream</span> ss<span class="token operator">=</span>CEP<span class="token punctuation">.</span><span class="token function">pattern</span><span class="token punctuation">(</span>dataStream<span class="token punctuation">,</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åŒ¹é…äº‹ä»¶</span>
<span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">flatSelect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/vbeats/vblog/edit/next/data/base/flink.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/12/8 ä¸Šåˆ8:04:33</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: bootvue@gmail.com">bootvue</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> â† <a href="/data/base/mapreduce.html" class="nav-link" aria-label="MapReduce"><!--[--><!--]--> MapReduce <!--[--><!--]--></a></span><span class="next"><a href="/data/base/kafka.html" class="nav-link" aria-label="Kafka ğŸ’¥"><!--[--><!--]--> Kafka ğŸ’¥ <!--[--><!--]--></a> â†’ </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.6686f77d.js" defer></script><script src="/assets/js/7.3d9f59d0.js" defer></script><script src="/assets/js/app.42261b4c.js" defer></script>
  </body>
</html>
