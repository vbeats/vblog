"use strict";(self.webpackChunkvblog=self.webpackChunkvblog||[]).push([[172],{6078:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-ae434738",path:"/frontend/article/sts.html",title:"STS",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"sts ä¸´æ—¶èº«ä»½éªŒè¯",slug:"sts-ä¸´æ—¶èº«ä»½éªŒè¯",children:[{level:3,title:"æ¡ˆä¾‹ ðŸ¦·",slug:"æ¡ˆä¾‹-ðŸ¦·",children:[]}]}],filePathRelative:"frontend/article/sts.md",git:{updatedTime:1637245438e3,contributors:[{name:"bootvue",email:"bootvue@gmail.com",commits:1}]}}},9383:(n,s,a)=>{a.r(s),a.d(s,{default:()=>C});var t=a(6252),e=a(1292);const c=(0,t._)("h1",{id:"sts",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#sts","aria-hidden":"true"},"#"),(0,t.Uk)(" STS")],-1),o=(0,t._)("h2",{id:"sts-ä¸´æ—¶èº«ä»½éªŒè¯",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#sts-ä¸´æ—¶èº«ä»½éªŒè¯","aria-hidden":"true"},"#"),(0,t.Uk)(" sts ä¸´æ—¶èº«ä»½éªŒè¯")],-1),l=(0,t._)("h3",{id:"æ¡ˆä¾‹-ðŸ¦·",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#æ¡ˆä¾‹-ðŸ¦·","aria-hidden":"true"},"#"),(0,t.Uk)(" æ¡ˆä¾‹ ðŸ¦·")],-1),p=(0,t._)("blockquote",null,[(0,t._)("p",null,"å®¢æˆ·ç«¯ä½¿ç”¨ STS ä¸´æ—¶å‡­è¯è®¿é—®äº‘æœåŠ¡")],-1),u=(0,t._)("p",null,[(0,t.Uk)("sts å…¨ç§° "),(0,t._)("code",null,"security token service"),(0,t.Uk)(", ç›®å‰ä¸»æµçš„äº‘æœåŠ¡å¹³å°åŸºæœ¬éƒ½æ”¯æŒ, ä¸‹æ–‡ä¸»è¦ä»¥é˜¿é‡Œäº‘ä¸ºæ¡ˆä¾‹è®²è§£, aws å¤§åŒå°å¼‚, å¯ä»¥ç±»æ¯”å‚è€ƒ. sts å¯ä»¥ä½¿å®¢æˆ·ç«¯ä¸æš´éœ² accessKey ä¸Ž accessSecret å®žçŽ°å¯¹äº‘æœåŠ¡çš„ç›´æŽ¥å®‰å…¨è¯·æ±‚è°ƒç”¨, å‡å°‘ä¸ŽåŽç«¯æŽ¥å£çš„äº¤äº’ä¸Žé¢å¤–çš„æµé‡æ¶ˆè€—.")],-1),_=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"TIP"),(0,t._)("p",null,[(0,t.Uk)("æœåŠ¡ç«¯ç”Ÿæˆ sts ä¸´æ—¶ token ä¸Ž signature, å®¢æˆ·ç«¯ç›´æŽ¥åŸºäºŽ "),(0,t._)("code",null,"sts token"),(0,t.Uk)("ã€"),(0,t._)("code",null,"signature"),(0,t.Uk)(" ç­¾åç­‰å¿…è¦çš„å‚æ•°ä¿¡æ¯å®žçŽ° OSS æ–‡ä»¶ä¸Šä¼ .")])],-1),k=(0,t._)("p",null,"ä½¿ç”¨ STS æŽˆæƒç”¨æˆ·ç›´æŽ¥è®¿é—® OSS çš„æµç¨‹å¦‚ä¸‹ï¼š (å›¾ç‰‡æ¥æº é˜¿é‡Œäº‘æ–‡æ¡£)",-1),i=(0,t._)("p",null,[(0,t._)("img",{src:e,alt:"sts"})],-1),r=(0,t._)("ol",null,[(0,t._)("li",null,[(0,t._)("p",null,[(0,t.Uk)("åˆ›å»ºç”¨äºŽ sts è®¤è¯çš„"),(0,t._)("code",null,"å­ç”¨æˆ·"),(0,t.Uk)(", å¤åˆ¶ä¸‹"),(0,t._)("code",null,"å­ç”¨æˆ·çš„ AccessKey ID ä¸Ž AccessKey Secret")])]),(0,t._)("li",null,[(0,t._)("p",null,[(0,t.Uk)("æ–°å»º "),(0,t._)("code",null,"Ram"),(0,t.Uk)(" è§’è‰², åˆ†é… "),(0,t._)("code",null,"AliyunSTSAssumeRoleAccess"),(0,t.Uk)(" çš„ç³»ç»Ÿç­–ç•¥æƒé™, åŒæ—¶æ–°å¢žæƒé™ç­–ç•¥, æ·»åŠ å¯¹åº”äº‘æœåŠ¡çš„ç­–ç•¥, ä»¥ oss ä¸ºä¾‹:")]),(0,t._)("p",null,"å…·ä½“ç­–ç•¥é…ç½®æ–¹å¼æŸ¥çœ‹æ–‡æ¡£, æˆ–è€…é€šè¿‡ç”Ÿæˆå™¨ç”Ÿæˆ.")])],-1),m=(0,t._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,t._)("pre",{class:"language-json"},[(0,t._)("code",null,[(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token property"},'"Version"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"1"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token property"},'"Statement"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token property"},'"Effect"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"Allow"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token property"},'"Action"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},'"oss:PutObject"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"oss:GetObject"'),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token property"},'"Resource"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},'"acs:oss:*:*:xx-bucket/oo"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"acs:oss:*:*:xx-bucket/oo/*"'),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br")])],-1),U=(0,t._)("ol",{start:"3"},[(0,t._)("li",null,[(0,t._)("p",null,[(0,t.Uk)("å¤åˆ¶ä¸‹ "),(0,t._)("code",null,"Ram"),(0,t.Uk)(" è§’è‰²çš„ "),(0,t._)("code",null,"ARN"),(0,t.Uk)(" å­—æ®µå€¼, ä¹Ÿå¯ä»¥ä¿®æ”¹"),(0,t._)("code",null,"æœ€å¤§ä¼šè¯æ—¶é—´"),(0,t.Uk)(".")])]),(0,t._)("li",null,[(0,t._)("p",null,[(0,t.Uk)("è´¦å·ç›¸å…³æƒé™åˆ†é…ç»“æŸ, ä¸‹é¢å¼€å§‹å†™æœåŠ¡ç«¯ä»£ç , ç”Ÿæˆ "),(0,t._)("code",null,"sts token"),(0,t.Uk)("ã€signature "),(0,t._)("code",null,"ã€"),(0,t.Uk)("policy` ç­‰ä¿¡æ¯.")])])],-1),b=(0,t._)("p",null,[(0,t.Uk)("æŽ¥å£è°ƒç”¨ä¹Ÿå¯ä»¥ç”¨ "),(0,t._)("code",null,"OpenAPI Explorer"),(0,t.Uk)(" è°ƒè¯•è¯·æ±‚")],-1),d=(0,t._)("p",null,"ä»¥ java ä»£ç ä¸ºä¾‹(åŸºäºŽæ—§ sdk):",-1),g=(0,t._)("div",{class:"language-java ext-java line-numbers-mode"},[(0,t._)("pre",{class:"language-java"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// STSæŽ¥å…¥åœ°å€ï¼Œä¾‹å¦‚sts.cn-hangzhou.aliyuncs.comã€‚"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" regionId "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'""'),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// å¡«å†™æ­¥éª¤1ç”Ÿæˆçš„è®¿é—®å¯†é’¥AccessKey IDå’ŒAccessKey Secretã€‚"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" accessKeyId "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"xxxxxxxxxx"'),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" accessKeySecret "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"ooooooooooo"'),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" endPoint "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"....."'),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("  "),(0,t._)("span",{class:"token comment"},"// oss bucket endpoint"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// å¡«å†™æ­¥éª¤3èŽ·å–çš„è§’è‰²ARNã€‚"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" roleArn "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" appConfig"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getAliArn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// è‡ªå®šä¹‰è§’è‰²ä¼šè¯åç§°ï¼Œç”¨æ¥åŒºåˆ†ä¸åŒçš„ä»¤ç‰Œï¼Œä¾‹å¦‚å¯å¡«å†™ä¸ºSessionTestã€‚"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" roleSessionName "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"xxTest"'),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"oo"'),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// oss bucket å†…æ–‡ä»¶å­è·¯å¾„"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"Long"),(0,t.Uk)(" maxFileSize "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"10"),(0,t.Uk)(" _ "),(0,t._)("span",{class:"token number"},"1024"),(0,t.Uk)(" _ "),(0,t._)("span",{class:"token number"},"1024L"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// æœ€å¤§ 10M"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 1 å°æ—¶æœ‰æ•ˆ"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"OffsetDateTime"),(0,t.Uk)(" expires "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"LocalDateTime"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"now"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"plusHours"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"1L"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"atOffset"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token class-name"},"ZoneOffset"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"of"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"+8"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nâ€‹\n"),(0,t._)("span",{class:"token keyword"},"try"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// sts token"),(0,t.Uk)("\n    â€‹\n    "),(0,t._)("span",{class:"token comment"},"// æž„é€  profileã€‚"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token class-name"},"IClientProfile"),(0,t.Uk)(" profile "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"DefaultProfile"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getProfile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("regionId"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" accessKeyId"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" accessKeySecret"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// æž„é€  clientã€‚"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token class-name"},"DefaultAcsClient"),(0,t.Uk)(" client "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"DefaultAcsClient"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("profile"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"final"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"AssumeRoleRequest"),(0,t.Uk)(" request "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"AssumeRoleRequest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setRoleArn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("roleArn"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setRoleSessionName"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("roleSessionName"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setDurationSeconds"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3600L"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// è®¾ç½®ä¸´æ—¶è®¿é—®å‡­è¯çš„æœ‰æ•ˆæ—¶é—´ä¸º 3600 ç§’ã€‚"),(0,t.Uk)("\n    â€‹\n    "),(0,t._)("span",{class:"token class-name"},"AssumeRoleResponse"),(0,t.Uk)(" response "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" client"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getAcsResponse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token class-name"},[(0,t.Uk)("AssumeRoleResponse"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("Credentials")]),(0,t.Uk)(" credentials "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" response"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getCredentials"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" stsToken "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" credentials"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getSecurityToken"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    â€‹\n    "),(0,t._)("span",{class:"token comment"},"// ç­¾å"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token class-name"},"OSS"),(0,t.Uk)(" ossClient "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"OSSClientBuilder"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"build"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("endPoint"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" credentials"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getAccessKeyId"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" credentials"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getAccessKeySecret"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" stsToken"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    â€‹\n    "),(0,t._)("span",{class:"token comment"},"// policy ç­–ç•¥, è¿›ä¸€æ­¥é™å®šæƒé™"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// ä¸´æ—¶è®¿é—®å‡­è¯æœ€åŽèŽ·å¾—çš„æƒé™æ˜¯æ­¥éª¤ 4 è®¾ç½®çš„è§’è‰²æƒé™å’Œè¯¥ Policy è®¾ç½®æƒé™çš„äº¤é›†ï¼Œ"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token class-name"},"PolicyConditions"),(0,t.Uk)(" policyConditions "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"PolicyConditions"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    policyConditions"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"addConditionItem"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token class-name"},"PolicyConditions"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("COND_CONTENT_LENGTH_RANGE"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" maxFileSize"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    â€‹\n    "),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" policy "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ossClient"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"generatePostPolicy"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token class-name"},"Date"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"from"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("expires"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toInstant"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" policyConditions"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token class-name"},"String"),(0,t.Uk)(" signature "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ossClient"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"calculatePostSignature"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("policy"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    â€‹\n    log"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"info"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"endpoint: {},policy: {},signature: {}, path: {}, accessKeyId: {}, sts_token: {}"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("endPoint"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Base64Utils"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"encodeToString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("policy"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getByte"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token class-name"},"StandardCharsets"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("UTF_8"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    signature"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" credentials"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getAccessKeyId"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" stsToken"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"catch"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token class-name"},"ClientException"),(0,t.Uk)(" e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    log"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"error"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"èŽ·å– sts token å¤±è´¥"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br")])],-1),f=(0,t._)("div",{class:"custom-container warning"},[(0,t._)("p",{class:"custom-container-title"},"WARNING"),(0,t._)("p",null,[(0,t.Uk)("æ³¨æ„: ç”Ÿæˆå®¢æˆ·ç«¯å‚æ•° "),(0,t._)("code",null,"signature"),(0,t.Uk)(" æ—¶, åŸºäºŽçš„æ˜¯ç”Ÿæˆ "),(0,t._)("code",null,"sts"),(0,t.Uk)(" æ—¶è¿”å›žçš„"),(0,t._)("code",null,"ä¸´æ—¶ AccessKeyId"),(0,t.Uk)(" å’Œ"),(0,t._)("code",null,"ä¸´æ—¶çš„ AccessKeySecret"),(0,t.Uk)(", åŒ…æ‹¬æœ€åŽå®¢æˆ·ç«¯å‘èµ· http è¯·æ±‚ä½¿ç”¨çš„ä¹Ÿæ˜¯ä¸Ž sts å¯¹åº”è¿”å›žçš„"),(0,t._)("code",null,"ä¸´æ—¶ AccessKeyId"),(0,t.Uk)(", è€Œä¸æ˜¯ä¸€å¼€å§‹åˆ›å»ºçš„"),(0,t._)("code",null,"å­ç”¨æˆ· id"),(0,t.Uk)(".")])],-1),y=(0,t._)("p",null,[(0,t.Uk)("æƒé™æ–¹é¢, ä¸€å®šæ˜¯ "),(0,t._)("code",null,"Ram"),(0,t.Uk)(" è§’è‰²æƒé™ã€"),(0,t._)("code",null,"policy"),(0,t.Uk)("ã€"),(0,t._)("code",null,"bucket"),(0,t.Uk)(" æƒé™çš„æœ€å°äº¤é›†. æ³¨æ„ä¸è¦æžçš„å¤ªå¤æ‚å•°å—¦æŠŠè‡ªå·±å¸¦æ²Ÿé‡Œ.")],-1),S=(0,t._)("ol",{start:"5"},[(0,t._)("li",null,"å®¢æˆ·ç«¯(webã€appã€å°ç¨‹åºã€postman ç­‰ç­‰)æ‹¿åˆ° sts tokenã€signatureã€policyã€ä¸´æ—¶çš„ accessKeyId ç­‰ä¿¡æ¯å°±å¯ä»¥ç›´æŽ¥å‘èµ· post è¯·æ±‚å‘ oss ä¸Šä¼ æ–‡ä»¶äº†.")],-1),h=(0,t._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,t._)("pre",{class:"language-bash"},[(0,t._)("code",null,[(0,t.Uk)("url: bucket endpoint\n\nè¯·æ±‚æ–¹å¼: post/form-data\n\nå‚æ•°:\nkey: ä¸Šä¼ åŽçš„æ–‡ä»¶è·¯å¾„+æ–‡ä»¶å\npolicy: policy json å­—ç¬¦ä¸²"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("base64"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nOSSAccessKeyId: ä¸´æ—¶çš„ accessKeyId\nsignature: åŸºäºŽä¸´æ—¶ accessKeyId accessKeySecret è®¡ç®—çš„ç­¾å\nx-oss-security-token: sts token\nfile: è¦ä¸Šä¼ çš„æ–‡ä»¶\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br")])],-1),A=(0,t._)("p",null,"æ€»ç»“: åŸºäºŽ sts å®¢æˆ·ç«¯æ–‡ä»¶ä¸Šä¼  oss, èŠ‚çœäº†æœåŠ¡ç«¯çš„å¸¦å®½æµé‡, å®‰å…¨å¯é , ä¸æ­¢ oss æœåŠ¡, ç»å¤§å¤šæ•°äº‘æœåŠ¡ä¹Ÿéƒ½å¯ä»¥åŸºäºŽ sts çš„æ–¹å¼è¯·æ±‚, å…·ä½“å¯ä»¥ç»“åˆé¡¹ç›®æƒ…å†µçµæ´»é€‰æ‹©.",-1),x={},C=(0,a(3744).Z)(x,[["render",function(n,s){return(0,t.wg)(),(0,t.iD)(t.HY,null,[c,o,l,p,u,_,k,i,r,m,U,b,d,g,f,y,S,h,A],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{for(const[a,t]of s)n[a]=t;return n}},1292:(n,s,a)=>{n.exports=a.p+"assets/img/sts.82e8c691.jpg"}}]);