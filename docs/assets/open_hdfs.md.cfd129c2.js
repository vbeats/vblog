import{o as a,c as n,d as s}from"./app.8862131a.js";const e='{"title":"HDFS","description":"","frontmatter":{},"headers":[{"level":2,"title":"Name Node","slug":"name-node"},{"level":2,"title":"Data Node","slug":"data-node"},{"level":2,"title":"Client","slug":"client"},{"level":2,"title":"Secondary NameNode","slug":"secondary-namenode"},{"level":2,"title":"回收站","slug":"回收站"},{"level":2,"title":"命令","slug":"命令"},{"level":2,"title":"Java","slug":"java"}],"relativePath":"open/hdfs.md","lastUpdated":1629208208435}',t={},o=s('<h1 id="hdfs"><a class="header-anchor" href="#hdfs" aria-hidden="true">#</a> HDFS</h1><blockquote><p>分布式文件系统, 文件数据只追加,不修改</p></blockquote><h2 id="name-node"><a class="header-anchor" href="#name-node" aria-hidden="true">#</a> Name Node</h2><ol><li>默认数据块大小 128M df.blocksize</li><li>data 元数据, 内存存储, 磁盘 FsImage 备份</li><li>内存数据更新, Edits 磁盘文件不断追加操作</li><li>data 数据校验和</li><li>维护 data node 的心跳检查</li></ol><h2 id="data-node"><a class="header-anchor" href="#data-node" aria-hidden="true">#</a> Data Node</h2><ol><li>集群启动后, data node 间隔上报数据块信息</li><li>小文件归档, 还是独立的文件, 对于 name node 封装成一个整体</li></ol><h2 id="client"><a class="header-anchor" href="#client" aria-hidden="true">#</a> Client</h2><blockquote><p>切分数据, 与 namenode&amp;datanode 交互</p></blockquote><h2 id="secondary-namenode"><a class="header-anchor" href="#secondary-namenode" aria-hidden="true">#</a> Secondary NameNode</h2><ol><li>监控 hdfs 运行状态, 辅助恢复 name node, 定期合并 FsImage 和 Edits &amp; 更新内存中的 NameNode 数据</li><li>checkpoint 默认 1 小时, txns 次数检查(合并 fsimage&amp;edits)</li></ol><h2 id="回收站"><a class="header-anchor" href="#回收站" aria-hidden="true">#</a> 回收站</h2><blockquote><p>core-site.xml</p></blockquote><ol><li>fs.trash.interval 0 禁用, 其他值: 存活时间(minutes)</li><li>fs.trash.checkpoint.interval 检查时间间隔</li></ol><h2 id="命令"><a class="header-anchor" href="#命令" aria-hidden="true">#</a> 命令</h2><blockquote><p>hadoop fs or hdfs dfs, dfs 是 fs 的实现类</p></blockquote><blockquote><p>hadoop distcp hdfs://… hdfs://… 集群间数据拷贝</p></blockquote><blockquote><p>hadoop archive -archiveName xxx.har -p /data/… /dest/… 归档文件</p></blockquote><blockquote><p>hadoop fs -ls -R har:///dest/…</p></blockquote><h2 id="java"><a class="header-anchor" href="#java" aria-hidden="true">#</a> Java</h2><blockquote><p>通过 FileSystem 操作 HDFS</p></blockquote><div class="language-java"><pre><code>        <span class="token class-name">Configuration</span> cfg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token class-name">FileSystem</span> fs <span class="token operator">=</span> <span class="token class-name">FileSystem</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>URI<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;hdfs://hadoop1:9000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cfg<span class="token punctuation">,</span> <span class="token string">&quot;battery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//boolean mkdirs = fs.mkdirs(new Path(&quot;/data&quot;));</span>\n        fs<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">&quot;/data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        fs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div>',21);t.render=function(s,e,t,l,p,c){return a(),n("div",null,[o])};export default t;export{e as __pageData};
