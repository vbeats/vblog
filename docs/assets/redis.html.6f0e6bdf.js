import{e as n}from"./app.07c9c92c.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";var a="/assets/redis.cb5e764f.png";const e={},t=n(`<h1 id="redis" tabindex="-1"><a class="header-anchor" href="#redis" aria-hidden="true">#</a> Redis</h1><p>\u563F\u563F\u563F</p><h2 id="redis-1" tabindex="-1"><a class="header-anchor" href="#redis-1" aria-hidden="true">#</a> Redis</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>redis-cli <span class="token operator">&gt;</span> info clients
redis-cli <span class="token operator">&gt;</span> client list
redis-cli <span class="token operator">&gt;</span> config get <span class="token function">timeout</span>

<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;timeout&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;0&quot;</span> <span class="token comment">#0\u8868\u793A\u4E0D\u5F00\u542F\u7A7A\u95F2\u6E05\u9664</span>
\u8BBE\u7F6E\u7A7A\u95F2\u6E05\u7406\u65F6\u95F4

redis-cli <span class="token operator">&gt;</span> config <span class="token builtin class-name">set</span> <span class="token function">timeout</span> <span class="token number">600</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="\u7F13\u5B58\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u7B56\u7565" aria-hidden="true">#</a> \u7F13\u5B58\u7B56\u7565:</h3><p>\u5F00\u542F\u5185\u5B58\u9650\u5236 <code>maxmemory bytes</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>noeviction: \u4E0D\u5220\u9664\u7B56\u7565, \u8FBE\u5230\u6700\u5927\u5185\u5B58\u9650\u5236\u65F6, \u5982\u679C\u9700\u8981\u66F4\u591A\u5185\u5B58, \u76F4\u63A5\u8FD4\u56DE\u9519\u8BEF\u4FE1\u606F\u3002
allkeys-lru: \u6240\u6709key\u901A\u7528<span class="token punctuation">;</span> \u4F18\u5148\u5220\u9664\u6700\u8FD1\u6700\u5C11\u4F7F\u7528<span class="token punctuation">(</span>less recently used ,LRU<span class="token punctuation">)</span> \u7684 key
volatile-lru: \u53EA\u9650\u4E8E\u8BBE\u7F6E\u4E86 expire \u7684\u90E8\u5206<span class="token punctuation">;</span> \u4F18\u5148\u5220\u9664\u6700\u8FD1\u6700\u5C11\u4F7F\u7528<span class="token punctuation">(</span>less recently used ,LRU<span class="token punctuation">)</span> \u7684 key
allkeys-random: \u6240\u6709key\u901A\u7528<span class="token punctuation">;</span> \u968F\u673A\u5220\u9664\u4E00\u90E8\u5206 key
volatile-random: \u53EA\u9650\u4E8E\u8BBE\u7F6E\u4E86 expire \u7684\u90E8\u5206<span class="token punctuation">;</span> \u968F\u673A\u5220\u9664\u4E00\u90E8\u5206 key
volatile-ttl: \u53EA\u9650\u4E8E\u8BBE\u7F6E\u4E86 expire \u7684\u90E8\u5206<span class="token punctuation">;</span> \u4F18\u5148\u5220\u9664\u5269\u4F59\u65F6\u95F4<span class="token punctuation">(</span>time to live,TTL<span class="token punctuation">)</span> \u77ED\u7684key
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol><li>RDB: \u624B\u52A8/\u81EA\u52A8\u89E6\u53D1,dump \u5FEB\u7167\u65B9\u5F0F, save m n: \u8868\u793A m \u79D2\u4E4B\u5185\u6570\u636E\u96C6\u5B58\u5728 n \u6B21\u4FEE\u6539\u65F6\uFF0C\u81EA\u52A8\u89E6\u53D1 bgsave</li><li>AOF: \u72EC\u7ACB log \u65E5\u5FD7\u8BB0\u5F55\u5199\u64CD\u4F5C always:\u6BCF\u6B21\u5199\u64CD\u4F5C\u90FD\u8BB0\u5F55 everysec: 1 \u79D2\u540C\u6B65\u8BB0\u5F55\u4E00\u6B21 no:\u4E0D\u540C\u6B65\u8BB0\u5F55</li><li>redis \u5BC6\u7801\u914D\u7F6E requirepass xxx</li><li>\u4E3B\u4ECE\u914D\u7F6E replicaof(slaveof) ip port</li><li>master \u6709\u5BC6\u7801\u7684\u8BDD masterauth xxx</li></ol><blockquote><p>\u54E8\u5175\u914D\u7F6E sentinel.conf</p></blockquote><ol><li>sentinel monitor master_name ip port \u7968\u6570(1,2....) ------&gt;\u76D1\u542C master, \u96C6\u7FA4\u4E0B\u4FDD\u8BC1 master_name \u4E00\u81F4, \u6700\u597D\u6BCF\u4E2A\u8282\u70B9\u90FD\u653E\u4E00\u4E2A sentinel.conf</li><li>\u542F\u52A8\u54E8\u5175 redis-sentinel /.....sentinel.conf</li><li>\u6709 redis-server \u6302\u6389, \u54E8\u5175\u4F1A\u91CD\u65B0\u9009\u62E9 master</li></ol><p><img src="`+a+`" alt="redis"></p><h3 id="redis-cluster" tabindex="-1"><a class="header-anchor" href="#redis-cluster" aria-hidden="true">#</a> redis-cluster</h3><blockquote><p>\u96C6\u7FA4\u540A\u70B8\u5929</p></blockquote><p>spring boot \u914D\u7F6E\u54E8\u5175:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">master</span><span class="token punctuation">:</span> testmaster
      <span class="token key atrule">nodes</span><span class="token punctuation">:</span> 192.168.142.88<span class="token punctuation">:</span><span class="token number">26379</span><span class="token punctuation">,</span>192.168.142.89<span class="token punctuation">:</span><span class="token number">26379</span><span class="token punctuation">,</span>192.168.142.90<span class="token punctuation">:</span><span class="token number">26379</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="springboot-\u67E5\u8BE2\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#springboot-\u67E5\u8BE2\u7F13\u5B58" aria-hidden="true">#</a> springboot \u67E5\u8BE2\u7F13\u5B58</h3><ol><li>springboot \u542F\u52A8\u7C7B\u4E0D\u8981\u5FD8\u8BB0@Enablecaching \u6CE8\u89E3</li><li>Controller \u67E5\u8BE2\u64CD\u4F5C, @Cacheable(cacheNames=&#39;&#39;,key=&#39;&#39;), \u67E5\u8BE2\u65B9\u6CD5\u8FD4\u56DE\u7684\u5BF9\u8C61\u8981\u80FD\u5E8F\u5217\u5316</li><li>\u66F4\u65B0\u6216\u8005\u5220\u9664\u7F13\u5B58@CachePut(cacheNames=&#39;&#39;,key=&#39;&#39;),\u66F4\u65B0\u7F13\u5B58\u6570\u636E @CacheEvict(cacheNames = &quot;&quot;),\u6E05\u9664\u7F13\u5B58</li><li>key \u5982\u679C\u4E0D\u586B,\u9ED8\u8BA4\u4E3A\u65B9\u6CD5\u7684\u53C2\u6570. \u7C7B\u4E0A\u914D\u7F6E@cacheconfig(cacheNames=&#39;&#39;),\u65B9\u6CD5\u4E0A\u53EF\u4EE5\u7701\u7565 cachename \u914D\u7F6E</li><li>key \u53EF\u4EE5\u5BF9\u5E94\u65B9\u6CD5\u7684\u53C2\u6570, condition \u7F13\u5B58\u7684\u6761\u4EF6, unless \u4E0D\u7F13\u5B58\u7684\u6761\u4EF6(#result \u4EE3\u8868\u8FD4\u56DE\u503C)</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/list&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames<span class="token operator">=</span><span class="token string">&quot;product&quot;</span><span class="token punctuation">,</span>key<span class="token operator">=</span><span class="token string">&quot;#id&quot;</span><span class="token punctuation">,</span>condition<span class="token operator">=</span><span class="token string">&quot;#id.length&gt;0&quot;</span><span class="token punctuation">,</span>unless<span class="token operator">=</span><span class="token string">&quot;#result.getCode()!=200&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Result</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>&quot;id<span class="token punctuation">)</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> xxxxx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,18);function p(l,o){return t}var r=s(e,[["render",p]]);export{r as default};
