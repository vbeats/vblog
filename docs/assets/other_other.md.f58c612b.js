import{o as n,c as s,d as a}from"./app.9f9f1749.js";const e='{"title":"å…¶å®ƒ","description":"","frontmatter":{},"headers":[{"level":2,"title":"systemctl æœåŠ¡","slug":"systemctl-æœåŠ¡"},{"level":2,"title":"å¹¶å‘ç¼–ç¨‹","slug":"å¹¶å‘ç¼–ç¨‹"},{"level":2,"title":"å‡½æ•°å¼ç¼–ç¨‹","slug":"å‡½æ•°å¼ç¼–ç¨‹"},{"level":2,"title":"Rabbit","slug":"rabbit"},{"level":3,"title":"æ³¨æ„:","slug":"æ³¨æ„"},{"level":3,"title":"exchange äº¤æ¢æœº","slug":"exchange-äº¤æ¢æœº"},{"level":3,"title":"message æ¶ˆæ¯","slug":"message-æ¶ˆæ¯"},{"level":3,"title":"æ­»ä¿¡é˜Ÿåˆ—(ç‰¹æ®Šçš„ exchange)","slug":"æ­»ä¿¡é˜Ÿåˆ—-ç‰¹æ®Šçš„-exchange"},{"level":3,"title":"æ¶ˆè´¹è€…","slug":"æ¶ˆè´¹è€…"},{"level":3,"title":"ç›‘å¬å™¨","slug":"ç›‘å¬å™¨"},{"level":3,"title":"é«˜å¯ç”¨","slug":"é«˜å¯ç”¨"},{"level":3,"title":"æ’ä»¶","slug":"æ’ä»¶"},{"level":2,"title":"Spring äº‹åŠ¡","slug":"spring-äº‹åŠ¡"},{"level":2,"title":"SpringMvc å¼‚æ­¥å¤„ç†","slug":"springmvc-å¼‚æ­¥å¤„ç†"},{"level":2,"title":"Dockerfile","slug":"dockerfile"},{"level":2,"title":"Gradle","slug":"gradle"},{"level":2,"title":"jiraé…ç½®","slug":"jiraé…ç½®"}],"relativePath":"other/other.md","lastUpdated":1627891509326}',t={},p=a('<h1 id="å…¶å®ƒ"><a class="header-anchor" href="#å…¶å®ƒ" aria-hidden="true">#</a> å…¶å®ƒ</h1><p>ä¹±ä¸ƒå…«ç³Ÿ ğŸ’£ğŸ’£ğŸ’£</p><h2 id="systemctl-æœåŠ¡"><a class="header-anchor" href="#systemctl-æœåŠ¡" aria-hidden="true">#</a> systemctl æœåŠ¡</h2><blockquote><p>/usr/lib/systemd/ä¸‹, å¼€æœºä¸ç™»å½•å°±èƒ½å¯åŠ¨çš„æœåŠ¡æœ€å¥½æ”¾åœ¨ /usr/lib/systemd/system ç³»ç»ŸæœåŠ¡, â€¦/user: ç”¨æˆ·æœåŠ¡ éœ€è¦ç”¨æˆ·ç™»å½•æ‰å¯ä»¥å¯åŠ¨</p></blockquote><div class="language-bash"><pre><code><span class="token comment"># [Unit]ã€[Service]å’Œ[Install]</span>\n<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>   <span class="token comment"># ä¸»è¦æ˜¯æœåŠ¡è¯´æ˜</span>\n<span class="token assign-left variable">Description</span><span class="token operator">=</span>test   <span class="token comment"># ç®€å•æè¿°æœåŠ¡</span>\n<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target    <span class="token comment"># æè¿°æœåŠ¡ç±»åˆ«ï¼Œè¡¨ç¤ºæœ¬æœåŠ¡éœ€è¦åœ¨networkæœåŠ¡å¯åŠ¨ååœ¨å¯åŠ¨</span>\n<span class="token assign-left variable">Before</span><span class="token operator">=</span>xxx.service      <span class="token comment"># è¡¨ç¤ºéœ€è¦åœ¨æŸäº›æœåŠ¡å¯åŠ¨ä¹‹å‰å¯åŠ¨ï¼ŒAfterå’ŒBeforeå­—æ®µåªæ¶‰åŠå¯åŠ¨é¡ºåºï¼Œä¸æ¶‰åŠä¾èµ–å…³ç³»</span>\n\n<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>  <span class="token comment"># æ ¸å¿ƒåŒºåŸŸ</span>\n<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking     <span class="token comment"># è¡¨ç¤ºåå°è¿è¡Œæ¨¡å¼ã€‚</span>\n<span class="token assign-left variable">User</span><span class="token operator">=</span>root        <span class="token comment"># è®¾ç½®æœåŠ¡è¿è¡Œçš„ç”¨æˆ·</span>\n<span class="token assign-left variable">Group</span><span class="token operator">=</span>root       <span class="token comment"># è®¾ç½®æœåŠ¡è¿è¡Œçš„ç”¨æˆ·ç»„</span>\n<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>control-group   <span class="token comment"># å®šä¹‰systemdå¦‚ä½•åœæ­¢æœåŠ¡</span>\n<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/usr/local/test/test.pid    <span class="token comment"># å­˜æ”¾PIDçš„ç»å¯¹è·¯å¾„</span>\n<span class="token assign-left variable">Restart</span><span class="token operator">=</span>no        <span class="token comment"># å®šä¹‰æœåŠ¡è¿›ç¨‹é€€å‡ºåï¼Œsystemdçš„é‡å¯æ–¹å¼ï¼Œé»˜è®¤æ˜¯ä¸é‡å¯</span>\n<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/test/bin/startup.sh    <span class="token comment"># æœåŠ¡å¯åŠ¨å‘½ä»¤ï¼Œå‘½ä»¤éœ€è¦ç»å¯¹è·¯å¾„</span>\n<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/xxxxx\n<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/xxxxx\n<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true                               <span class="token comment"># è¡¨ç¤ºç»™æœåŠ¡åˆ†é…ç‹¬ç«‹çš„ä¸´æ—¶ç©ºé—´</span>\n\n<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>\n<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target  <span class="token comment"># å¤šç”¨æˆ·</span>\n\n<span class="token comment">#Typeçš„ç±»å‹æœ‰ï¼š</span>\n<span class="token comment">#    simple(é»˜è®¤ï¼‰ï¼š# ä»¥ExecStartå­—æ®µå¯åŠ¨çš„è¿›ç¨‹ä¸ºä¸»è¿›ç¨‹</span>\n<span class="token comment">#    forking:  # ExecStartå­—æ®µä»¥fork()æ–¹å¼å¯åŠ¨ï¼Œæ­¤æ—¶çˆ¶è¿›ç¨‹å°†é€€å‡ºï¼Œå­è¿›ç¨‹å°†æˆä¸ºä¸»è¿›ç¨‹ï¼ˆåå°è¿è¡Œï¼‰ã€‚ä¸€èˆ¬éƒ½è®¾ç½®ä¸ºforking</span>\n<span class="token comment">#    oneshot:  # ç±»ä¼¼äºsimpleï¼Œä½†åªæ‰§è¡Œä¸€æ¬¡ï¼Œsystemdä¼šç­‰å®ƒæ‰§è¡Œå®Œï¼Œæ‰å¯åŠ¨å…¶ä»–æœåŠ¡</span>\n<span class="token comment">#    dbusï¼š    # ç±»ä¼¼äºsimple, ä½†ä¼šç­‰å¾…D-Busä¿¡å·åå¯åŠ¨</span>\n<span class="token comment">#    notify:   # ç±»ä¼¼äºsimple, å¯åŠ¨ç»“æŸåä¼šå‘å‡ºé€šçŸ¥ä¿¡å·ï¼Œç„¶åsystemdå†å¯åŠ¨å…¶ä»–æœåŠ¡</span>\n<span class="token comment">#    idleï¼š    # ç±»ä¼¼äºsimpleï¼Œä½†æ˜¯è¦ç­‰åˆ°å…¶ä»–ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œæ‰ä¼šå¯åŠ¨è¯¥æœåŠ¡ã€‚</span>\n<span class="token comment">#</span>\n<span class="token comment">#EnvironmentFile:</span>\n<span class="token comment">#    æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œå’Œè¿è¯å·ç»„åˆä½¿ç”¨ï¼Œå¯ä»¥é¿å…é…ç½®æ–‡ä»¶ä¸å­˜åœ¨çš„å¼‚å¸¸ã€‚</span>\n<span class="token comment">#</span>\n<span class="token comment">#Environment:</span>\n<span class="token comment">#    åé¢æ¥å¤šä¸ªä¸åŒçš„shellå˜é‡ã€‚</span>\n<span class="token comment">#    ä¾‹å¦‚ï¼š</span>\n<span class="token comment">#    Environment=DATA_DIR=/data/elk</span>\n<span class="token comment">#    Environment=LOG_DIR=/var/log/elasticsearch</span>\n<span class="token comment">#    Environment=PID_DIR=/var/run/elasticsearch</span>\n<span class="token comment">#    EnvironmentFile=-/etc/sysconfig/elasticsearch</span>\n<span class="token comment">#</span>\n<span class="token comment">#è¿è¯å·ï¼ˆ-ï¼‰ï¼šåœ¨æ‰€æœ‰å¯åŠ¨è®¾ç½®ä¹‹å‰ï¼Œæ·»åŠ çš„å˜é‡å­—æ®µï¼Œéƒ½å¯ä»¥åŠ ä¸Šè¿è¯å·</span>\n<span class="token comment">#    è¡¨ç¤ºæŠ‘åˆ¶é”™è¯¯ï¼Œå³å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¸å½±å“å…¶ä»–å‘½ä»¤çš„æ‰§è¡Œã€‚</span>\n<span class="token comment">#    æ¯”å¦‚`EnviromentFile=-/etc/sysconfig/xxx` è¡¨ç¤ºå³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šæŠ›å¼‚å¸¸</span>\n<span class="token comment">#</span>\n<span class="token comment">#KillModeçš„ç±»å‹ï¼š</span>\n<span class="token comment">#    control-group(é»˜è®¤)ï¼š# å½“å‰æ§åˆ¶ç»„é‡Œçš„æ‰€æœ‰å­è¿›ç¨‹ï¼Œéƒ½ä¼šè¢«æ€æ‰</span>\n<span class="token comment">#    process: # åªæ€ä¸»è¿›ç¨‹</span>\n<span class="token comment">#    mixed:   # ä¸»è¿›ç¨‹å°†æ”¶åˆ°SIGTERMä¿¡å·ï¼Œå­è¿›ç¨‹æ”¶åˆ°SIGKILLä¿¡å·</span>\n<span class="token comment">#    none:    # æ²¡æœ‰è¿›ç¨‹ä¼šè¢«æ€æ‰ï¼Œåªæ˜¯æ‰§è¡ŒæœåŠ¡çš„stopå‘½ä»¤</span>\n<span class="token comment">#Restartçš„ç±»å‹ï¼š</span>\n<span class="token comment">#    no(é»˜è®¤å€¼)ï¼š # é€€å‡ºåæ— æ“ä½œ</span>\n<span class="token comment">#    on-success:  # åªæœ‰æ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€ç ä¸º0ï¼‰,æ‰ä¼šé‡å¯</span>\n<span class="token comment">#    on-failure:  # éæ­£å¸¸é€€å‡ºæ—¶ï¼Œé‡å¯ï¼ŒåŒ…æ‹¬è¢«ä¿¡å·ç»ˆæ­¢å’Œè¶…æ—¶ç­‰</span>\n<span class="token comment">#    on-abnormal: # åªæœ‰è¢«ä¿¡å·ç»ˆæ­¢æˆ–è¶…æ—¶ï¼Œæ‰ä¼šé‡å¯</span>\n<span class="token comment">#    on-abort:    # åªæœ‰åœ¨æ”¶åˆ°æ²¡æœ‰æ•æ‰åˆ°çš„ä¿¡å·ç»ˆæ­¢æ—¶ï¼Œæ‰ä¼šé‡å¯</span>\n<span class="token comment">#    on-watchdog: # è¶…æ—¶é€€å‡ºæ—¶ï¼Œæ‰ä¼šé‡å¯</span>\n<span class="token comment">#    always:      # ä¸ç®¡ä»€ä¹ˆé€€å‡ºåŸå› ï¼Œéƒ½ä¼šé‡å¯</span>\n<span class="token comment">#    # å¯¹äºå®ˆæŠ¤è¿›ç¨‹ï¼Œæ¨èç”¨on-failure</span>\n<span class="token comment">#RestartSecå­—æ®µï¼š</span>\n<span class="token comment">#    è¡¨ç¤ºsystemdé‡å¯æœåŠ¡ä¹‹å‰ï¼Œéœ€è¦ç­‰å¾…çš„ç§’æ•°ï¼šRestartSec: 30</span>\n<span class="token comment">#</span>\n<span class="token comment">#å„ç§Exec*å­—æ®µï¼š</span>\n<span class="token comment">#    # Exec* åé¢æ¥çš„å‘½ä»¤ï¼Œä»…æ¥å—â€œæŒ‡ä»¤ å‚æ•° å‚æ•°..â€æ ¼å¼ï¼Œä¸èƒ½æ¥å—&lt;&gt;|&amp;ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¾ˆå¤šbashè¯­æ³•ä¹Ÿä¸æ”¯æŒã€‚å¦‚æœæƒ³æ”¯æŒbashè¯­æ³•ï¼Œéœ€è¦è®¾ç½®Tyep=oneshot</span>\n<span class="token comment">#    ExecStartï¼š    # å¯åŠ¨æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</span>\n<span class="token comment">#    ExecReloadï¼š   # é‡å¯æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</span>\n<span class="token comment">#    ExecStopï¼š     # åœæ­¢æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</span>\n<span class="token comment">#    ExecStartPreï¼š # å¯åŠ¨æœåŠ¡å‰æ‰§è¡Œçš„å‘½ä»¤</span>\n<span class="token comment">#    ExecStartPostï¼š# å¯åŠ¨æœåŠ¡åæ‰§è¡Œçš„å‘½ä»¤</span>\n<span class="token comment">#    ExecStopPostï¼š # åœæ­¢æœåŠ¡åæ‰§è¡Œçš„å‘½ä»¤</span>\n<span class="token comment">#</span>\n<span class="token comment">#</span>\n<span class="token comment">#WantedByå­—æ®µï¼š</span>\n<span class="token comment">#    multi-user.target: # è¡¨ç¤ºå¤šç”¨æˆ·å‘½ä»¤è¡ŒçŠ¶æ€ï¼Œè¿™ä¸ªè®¾ç½®å¾ˆé‡è¦</span>\n<span class="token comment">#    graphical.target:  # è¡¨ç¤ºå›¾å½¢ç”¨æˆ·çŠ¶ä½“ï¼Œå®ƒä¾èµ–äºmulti-user.target</span>\n</code></pre></div><h2 id="å¹¶å‘ç¼–ç¨‹"><a class="header-anchor" href="#å¹¶å‘ç¼–ç¨‹" aria-hidden="true">#</a> å¹¶å‘ç¼–ç¨‹</h2><p><code>Executors</code> çº¿ç¨‹æ±  <code>newFixedThreadPool</code> <code>newCachedThreadPool</code> <code>newSingleThreadExecutor</code> <code>newScheduledThreadPool</code>, æœ€å¥½é€šè¿‡<code>ThreadPoolExecutor</code>åˆ›å»ºçº¿ç¨‹æ± </p><p>æ–¹æ³•: <code>execute(Runable)</code> <code>shutdown()</code> <code>Future&lt;T&gt; submit(Callable)</code></p><p><code>Future</code> æ–¹æ³•<code>isDone()</code>åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæˆ, <code>get()</code>è·å–ç»“æœ <code>cancel()</code>å–æ¶ˆä»»åŠ¡</p><h2 id="å‡½æ•°å¼ç¼–ç¨‹"><a class="header-anchor" href="#å‡½æ•°å¼ç¼–ç¨‹" aria-hidden="true">#</a> å‡½æ•°å¼ç¼–ç¨‹</h2><p><code>Function</code>: apply andThen <code>Consumer</code>: accept æ–¹æ³• <code>Predicate</code> test æ–¹æ³• <code>Supplier</code>: get æ–¹æ³•</p><h2 id="rabbit"><a class="header-anchor" href="#rabbit" aria-hidden="true">#</a> Rabbit</h2><h3 id="æ³¨æ„"><a class="header-anchor" href="#æ³¨æ„" aria-hidden="true">#</a> æ³¨æ„:</h3><ol><li>å¦‚æœä¸æŒ‡å®š exchange, é»˜è®¤èµ° amqp default exchange, ==routing-key==ä¸==queue==ååŒ¹é…ä¸€è‡´æŠ•é€’</li></ol><h3 id="exchange-äº¤æ¢æœº"><a class="header-anchor" href="#exchange-äº¤æ¢æœº" aria-hidden="true">#</a> exchange äº¤æ¢æœº</h3><ol><li>direct: ==routing-key==å¿…é¡»å®Œå…¨åŒ¹é…</li><li>topic: ==routing-key==æ¨¡ç³ŠåŒ¹é…</li></ol><blockquote><p>#åŒ¹é…å¤šä¸ªè¯ *åŒ¹é…ä¸€ä¸ªè¯</p></blockquote><ol start="3"><li>fanout: ==ä¸å¤„==ç† routing-key, exchange ä¸ queue ç›´æ¥ç»‘å®š</li></ol><h3 id="message-æ¶ˆæ¯"><a class="header-anchor" href="#message-æ¶ˆæ¯" aria-hidden="true">#</a> message æ¶ˆæ¯</h3><ol><li>å¯ä»¥æºå¸¦ properties å±æ€§</li><li>==mandotary===true, å‘é€ç«¯ä¼šç›‘å¬åˆ°è·¯ç”±ä¸åˆ°çš„æ¶ˆæ¯, å³ returnCallback, =false æ—¶, è·¯ç”±ä¸åˆ°çš„æ¶ˆæ¯ä¼šè¢«è‡ªåŠ¨åˆ é™¤</li><li>å‘é€ç«¯è¦å¤„ç†==confirmCallback== ==returnCallback==, é…ç½®é‡Œè¿™ä¸¤é¡¹å¿…é¡»è®¾ä¸º true</li><li></li></ol><h3 id="æ­»ä¿¡é˜Ÿåˆ—-ç‰¹æ®Šçš„-exchange"><a class="header-anchor" href="#æ­»ä¿¡é˜Ÿåˆ—-ç‰¹æ®Šçš„-exchange" aria-hidden="true">#</a> æ­»ä¿¡é˜Ÿåˆ—(ç‰¹æ®Šçš„ exchange)</h3><ol><li>æ¶ˆæ¯è¢« nack å¹¶ä¸” requeue=false</li><li>ttl æ¶ˆæ¯è¿‡æœŸ</li><li>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦</li></ol><div class="language-bash"><pre><code>ç§ä¿¡: å°±æ˜¯æ™®é€šçš„exchange--<span class="token operator">&gt;</span>queueç»‘å®š\n\nä¸šåŠ¡queue æ·»åŠ é¢å¤–çš„å‚æ•°: x-dead-letter-exchange<span class="token operator">=</span>æ­»ä¿¡äº¤æ¢æœº\n\nè¿™æ ·ä¸šåŠ¡queueä¸Šæœªæ¶ˆè´¹çš„æ¶ˆæ¯å°±è·¯ç”±åˆ°äº†ç§ä¿¡äº¤æ¢æœºä¸Š\n</code></pre></div><h3 id="æ¶ˆè´¹è€…"><a class="header-anchor" href="#æ¶ˆè´¹è€…" aria-hidden="true">#</a> æ¶ˆè´¹è€…</h3><div class="language-java"><pre><code><span class="token annotation punctuation">@Component</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>\n\n    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;test.queue&quot;</span><span class="token punctuation">,</span> durable <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> autoDelete <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n            exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;test.exchange&quot;</span><span class="token punctuation">,</span> durable <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> autoDelete <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n            key <span class="token operator">=</span> <span class="token string">&quot;test.#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token annotation punctuation">@RabbitHandler</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h3 id="ç›‘å¬å™¨"><a class="header-anchor" href="#ç›‘å¬å™¨" aria-hidden="true">#</a> ç›‘å¬å™¨</h3><ol><li>simpleMessageListenerContainer</li></ol><p>ä¸ºé˜Ÿåˆ—æ·»åŠ ç›‘å¬äº‹ä»¶</p><ol start="2"><li><p>messageListenerAdapter æ¶ˆæ¯é€‚é…å™¨</p><p>å¤„ç†æ–¹æ³• å¯ä»¥ä¸ºæ¯ä¸ªé˜Ÿåˆ—æŒ‡å®šä¸åŒçš„å¤„ç†æ–¹æ³•</p></li><li><p>messageConvert æ¶ˆæ¯è½¬åŒ–å™¨ java å¯¹è±¡ä¸ message å¯¹è±¡äº’è½¬</p></li></ol><h3 id="é«˜å¯ç”¨"><a class="header-anchor" href="#é«˜å¯ç”¨" aria-hidden="true">#</a> é«˜å¯ç”¨</h3><ol><li><p>é•œåƒé˜Ÿåˆ— : é…ç½® 1 ä¸ª Master, å¤šä¸ª Slaver</p><div class="language-bash"><pre><code> <span class="token number">1</span>. masterèŠ‚ç‚¹ /var/lib/rabbitmq/.erlang.cookie æ‹·è´åˆ°å„ä¸ªèŠ‚ç‚¹\n <span class="token number">2</span>. å¯åŠ¨æœåŠ¡ rabbitmq-server -detached\n <span class="token number">3</span>. å¤‡ç”¨èŠ‚ç‚¹åœæ­¢æœåŠ¡ rabbitmqctl stop_app\n <span class="token number">4</span>. å¤‡ç”¨èŠ‚ç‚¹åŠ å…¥åˆ°ä¸»èŠ‚ç‚¹é›†ç¾¤ä¸­ rabbitmqctl join_cluster rabbit@xxxx<span class="token punctuation">(</span>hostså<span class="token punctuation">)</span>\n <span class="token number">5</span>. å¤‡ç”¨èŠ‚ç‚¹å¯åŠ¨ rabbitmqctl start_app\n <span class="token number">6</span>. ä»»æ„èŠ‚ç‚¹è®¾ç½®é›†ç¾¤å rabbitmqctl set_cluster_name xxxx\n <span class="token number">7</span>. æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ rabbitmqctl cluster_status\n <span class="token number">8</span>. é…ç½®é•œåƒé˜Ÿåˆ—: rabbitmqctl set_policy ha-all <span class="token string">&quot;^&quot;</span> <span class="token string">&#39;{&quot;ha-mode&quot;:&quot;all}&#39;</span>\n</code></pre></div></li><li><p>haproxy: è´Ÿè½½å‡è¡¡</p></li></ol><h3 id="æ’ä»¶"><a class="header-anchor" href="#æ’ä»¶" aria-hidden="true">#</a> æ’ä»¶</h3><ol><li>å»¶æ—¶æ’ä»¶<code>rabbitmq_delayed_message_exchange</code><div class="language-bash"><pre><code> <span class="token number">1</span>. /usr/lib/rabbitmq/lib/rabbitmq_serverxxx/plugins\n <span class="token number">2</span>. rabbitmq-plugins <span class="token builtin class-name">enable</span> xxxx\n <span class="token number">3</span>. å£°æ˜ä¸€ä¸ªx-delayed-typeç±»å‹çš„exchange\n <span class="token number">4</span>. å‘é€æ¶ˆæ¯æ—¶,æ¶ˆæ¯headerséœ€è¦æŒ‡å®šx-delay<span class="token operator">=</span>xxæ¯«ç§’\n</code></pre></div></li></ol><h2 id="spring-äº‹åŠ¡"><a class="header-anchor" href="#spring-äº‹åŠ¡" aria-hidden="true">#</a> Spring äº‹åŠ¡</h2><p>éš”ç¦»çº§åˆ«:</p><div class="language-"><pre><code>ISOLATION_DEFAULT\tä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«\nISOLATION_READ_UNCOMMITTED\tå…è®¸è¯»å–å°šæœªæäº¤çš„æ›´æ”¹ã€‚å¯èƒ½å¯¼è‡´è„è¯»ã€å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»\nISOLATION_READ_COMMITTED\tå…è®¸ä»å·²ç»æäº¤çš„å¹¶å‘äº‹åŠ¡è¯»å–ã€‚å¯é˜²æ­¢è„è¯»ï¼Œä½†å¹»è¯»å’Œä¸å¯é‡å¤è¯»ä»å¯èƒ½ä¼šå‘ç”Ÿ\nISOLATION_REPEATABLE_READ\tå¯¹ç›¸åŒå­—æ®µçš„å¤šæ¬¡è¯»å–çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®è¢«å½“å‰äº‹åŠ¡æœ¬èº«æ”¹å˜ã€‚å¯é˜²æ­¢è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†å¹»è¯»ä»å¯èƒ½å‘ç”Ÿ\nISOLATION_SERIALIZABLE\tå®Œå…¨æœä»ACIDçš„éš”ç¦»çº§åˆ«ï¼Œç¡®ä¿ä¸å‘ç”Ÿè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚è¿™åœ¨æ‰€æœ‰éš”ç¦»çº§åˆ«ä¸­ä¹Ÿæ˜¯æœ€æ…¢çš„ï¼Œå› ä¸ºå®ƒé€šå¸¸æ˜¯é€šè¿‡å®Œå…¨é”å®šå½“å‰äº‹åŠ¡æ‰€æ¶‰åŠçš„æ•°æ®è¡¨æ¥å®Œæˆçš„, å¯ä»¥åŠ å…±äº«é”(ä¸æ’ä»–), ä¸€ä¸ªäº‹åŠ¡ä¸é‡Šæ”¾,å…¶å®ƒäº‹åŠ¡åªèƒ½è¯»æ•°æ®\n</code></pre></div><p>ä¼ æ’­æœºåˆ¶:</p><div class="language-"><pre><code>PROPAGATION_MANDATORY\tè¡¨ç¤ºè¯¥æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡æ­£åœ¨å‘ç”Ÿï¼Œå°†æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸\nPROPAGATION_NESTED\tè¡¨ç¤ºå¦‚æœå½“å‰æ­£æœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿›è¡Œä¸­ï¼Œåˆ™è¯¥æ–¹æ³•åº”å½“è¿è¡Œåœ¨ä¸€ä¸ªåµŒå¥—å¼äº‹åŠ¡ä¸­ã€‚è¢«åµŒå¥—çš„äº‹åŠ¡å¯ä»¥ç‹¬ç«‹äºå°è£…äº‹åŠ¡è¿›è¡Œæäº¤æˆ–å›æ»šã€‚å¦‚æœå°è£…äº‹åŠ¡ä¸å­˜åœ¨ï¼Œè¡Œä¸ºå°±åƒPROPAGATION_REQUIRESä¸€æ ·ã€‚\nPROPAGATION_NEVER\tè¡¨ç¤ºå½“å‰çš„æ–¹æ³•ä¸åº”è¯¥åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡æ­£åœ¨è¿›è¡Œï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚\nPROPAGATION_NOT_SUPPORTED\tè¡¨ç¤ºè¯¥æ–¹æ³•ä¸åº”è¯¥åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚å¦‚æœä¸€ä¸ªç°æœ‰äº‹åŠ¡æ­£åœ¨è¿›è¡Œä¸­ï¼Œå®ƒå°†åœ¨è¯¥æ–¹æ³•çš„è¿è¡ŒæœŸé—´è¢«æŒ‚èµ·ã€‚\nPROPAGATION_SUPPORTS\tè¡¨ç¤ºå½“å‰æ–¹æ³•ä¸éœ€è¦äº‹åŠ¡æ€§ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯å¦‚æœæœ‰ä¸€ä¸ªäº‹åŠ¡å·²ç»åœ¨è¿è¡Œçš„è¯ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªäº‹åŠ¡é‡Œè¿è¡Œã€‚\nPROPAGATION_REQUIRES_NEW\tè¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»åœ¨å®ƒè‡ªå·±çš„äº‹åŠ¡é‡Œè¿è¡Œã€‚ä¸€ä¸ªæ–°çš„äº‹åŠ¡å°†è¢«å¯åŠ¨ï¼Œè€Œä¸”å¦‚æœæœ‰ä¸€ä¸ªç°æœ‰äº‹åŠ¡åœ¨è¿è¡Œçš„è¯ï¼Œåˆ™å°†åœ¨è¿™ä¸ªæ–¹æ³•è¿è¡ŒæœŸé—´è¢«æŒ‚èµ·ã€‚\nPROPAGATION_REQUIRES\tè¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚å¦‚æœä¸€ä¸ªç°æœ‰äº‹åŠ¡æ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯¥æ–¹æ³•å°†åœ¨é‚£ä¸ªäº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦åˆ™å°±è¦å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡ã€‚\n</code></pre></div><h2 id="springmvc-å¼‚æ­¥å¤„ç†"><a class="header-anchor" href="#springmvc-å¼‚æ­¥å¤„ç†" aria-hidden="true">#</a> SpringMvc å¼‚æ­¥å¤„ç†</h2><p>Callable å¤šçº¿ç¨‹æ¨¡å¼: ä¸»çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´é˜»å¡</p><div class="language-java"><pre><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/demo&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>\n\n        <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> callable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token annotation punctuation">@Override</span>\n            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>\n                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> callable<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n</code></pre></div><p>DeferredResult: æ¥å—è¯·æ±‚â€”&gt;å¤„ç†ä»»åŠ¡| |å¤„ç†å®Œæ¯•â€“&gt;å“åº”ç»“æœ</p><h2 id="dockerfile"><a class="header-anchor" href="#dockerfile" aria-hidden="true">#</a> Dockerfile</h2><div class="language-docker"><pre><code><span class="token instruction"><span class="token keyword">from</span>  å¿…é¡»æ˜¯ç¬¬ä¸€è¡Œ</span>\n<span class="token instruction"><span class="token keyword">maintainer</span> ä½œè€…ä¿¡æ¯</span>\n<span class="token instruction"><span class="token keyword">add</span> copy æ‹·è´æ–‡ä»¶, addåŠŸèƒ½æ›´å¤š, ä½ çŒœéƒ½æœ‰ä»€ä¹ˆåŠŸèƒ½?</span>\n<span class="token instruction"><span class="token keyword">run</span>  æ„å»ºæ—¶çš„å‘½ä»¤</span>\n<span class="token instruction"><span class="token keyword">expose</span>  æš´éœ²ç«¯å£,åªæ˜¯å»ºè®®,    å®é™…ä½¿ç”¨æ—¶è¿˜éœ€è¦æ‰‹åŠ¨-p  æŒ‡å®šç«¯å£æ˜ å°„</span>\n<span class="token instruction"><span class="token keyword">workdir</span> æŒ‡å®šå·¥ä½œç›®å½• å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ä¼šåœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œ</span>\n<span class="token instruction"><span class="token keyword">cmd</span>  è¿è¡Œæ—¶å‘½ä»¤,  ä¼šè¢«ä½¿ç”¨æ—¶å®¹å™¨çš„å‘½ä»¤è¦†ç›–</span>\n<span class="token instruction"><span class="token keyword">entrypoint</span>  ä¸ä¼šè¢«å®¹å™¨è¿è¡Œæ—¶å‘½ä»¤è¦†ç›–</span>\n</code></pre></div><blockquote><p>ADD COPY ENV EXPOSE FROM LABEL STOPSIGNAL USER VOLUME WORKDIR</p></blockquote><ol><li>æ„å»º docker é•œåƒ</li></ol><div class="language-bash"><pre><code>docker build -t tagåç§° <span class="token builtin class-name">.</span>\n<span class="token builtin class-name">.</span> æŒ‡å®šDockerfileæ‰€åœ¨è·¯å¾„\n</code></pre></div><ol start="2"><li>ç™»å½•åˆ° hub</li></ol><div class="language-bash"><pre><code>docker login\n</code></pre></div><ol start="3"><li>æ¨é€</li></ol><div class="language-bash"><pre><code>docker push <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> NAME<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span>\n</code></pre></div><h2 id="gradle"><a class="header-anchor" href="#gradle" aria-hidden="true">#</a> Gradle</h2><p>gradle ä»»åŠ¡: å¾€ nexus å‘å¸ƒ jar</p><div class="language-groovy"><pre><code><span class="token comment">//Mavenä»“åº“çš„URL</span>\n<span class="token keyword">def</span> MAVEN_REPO_RELEASE_URL<span class="token operator">=</span> <span class="token string">&#39;http://xxxx/nexus/content/repositories/releases/&#39;</span>\n<span class="token keyword">def</span> MAVEN_REPO_SNAPSHOT_URL<span class="token operator">=</span> <span class="token string">&#39;http://xxxxx/nexus/content/repositories/snapshots/&#39;</span>\n<span class="token comment">//ç™»å½•nexus çš„ç”¨æˆ·å</span>\n<span class="token keyword">def</span> NEXUS_USERNAME<span class="token operator">=</span><span class="token string">&#39;admin&#39;</span>\n<span class="token comment">//ç™»å½•nexus çš„å¯†ç </span>\n<span class="token keyword">def</span> NEXUS_PASSWORD<span class="token operator">=</span><span class="token string">&#39;admin&#39;</span>\n<span class="token keyword">def</span> ARTIFACT_ID <span class="token operator">=</span> <span class="token string">&#39;demo&#39;</span>\n<span class="token comment">// type</span>\n<span class="token keyword">def</span> TYPE <span class="token operator">=</span> <span class="token string">&#39;jar&#39;</span>\n<span class="token comment">//description</span>\n<span class="token keyword">def</span> DESCRIPTION <span class="token operator">=</span> <span class="token string">&#39;è¿™é‡Œæ˜¯æè¿°&#39;</span>\n\nuploadArchives <span class="token punctuation">{</span>\n    configuration <span class="token operator">=</span> configurations<span class="token punctuation">.</span>archives\n    repositories <span class="token punctuation">{</span>\n        mavenDeployer <span class="token punctuation">{</span>\n            <span class="token function">snapshotRepository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> MAVEN_REPO_SNAPSHOT_URL<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token function">authentication</span><span class="token punctuation">(</span>userName<span class="token punctuation">:</span> NEXUS_USERNAME<span class="token punctuation">,</span> password<span class="token punctuation">:</span> NEXUS_PASSWORD<span class="token punctuation">)</span>\n            <span class="token punctuation">}</span>\n            <span class="token function">repository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> MAVEN_REPO_RELEASE_URL<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token function">authentication</span><span class="token punctuation">(</span>userName<span class="token punctuation">:</span> NEXUS_USERNAME<span class="token punctuation">,</span> password<span class="token punctuation">:</span> NEXUS_PASSWORD<span class="token punctuation">)</span>\n            <span class="token punctuation">}</span>\n            <span class="token function">repository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&#39;C:\\\\Users\\\\dd\\\\.m2\\\\repository&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//å®šä¹‰æœ¬åœ°mavenä»“åº“çš„åœ°å€</span>\n            <span class="token function">repository</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&#39;C:\\\\Users\\\\dd\\\\.gradle\\\\caches\\\\modules-2\\\\files-2.1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//å®šä¹‰æœ¬åœ°Gradleä»“åº“çš„åœ°å€</span>\n            pom<span class="token punctuation">.</span>project <span class="token punctuation">{</span>\n                version version\n                artifactId ARTIFACT_ID\n                groupId group\n                packaging TYPE\n                description DESCRIPTION\n                licenses <span class="token punctuation">{</span>\n                    license <span class="token punctuation">{</span>\n                        name <span class="token string">&#39;The Apache Software License, Version 2.0&#39;</span>\n                        url <span class="token string">&#39;http://www.apache.org/licenses/LICENSE-2.0.txt&#39;</span>\n                        distribution <span class="token string">&#39;xxxxxx&#39;</span>\n                    <span class="token punctuation">}</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h2 id="jiraé…ç½®"><a class="header-anchor" href="#jiraé…ç½®" aria-hidden="true">#</a> jiraé…ç½®</h2><p><code>setenv.sh</code></p><div class="language-bash"><pre><code>JVM_SUPPORT_RECOMMENDED_ARGS:<span class="token operator">=</span><span class="token string">&quot;-Duser.timezone=Asia/Shanghai&quot;</span>\n\n<span class="token builtin class-name">export</span> <span class="token assign-left variable">CATALINA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-javaagent:/var/atlassian/application-data/jira/agent.jar <span class="token variable">${CATALINA_OPTS}</span>&quot;</span>\n</code></pre></div><p><code>confluence setenv.sh</code></p><div class="language-bash"><pre><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">CATALINA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-javaagent:/var/atlassian/application-data/confluence/agent.jar <span class="token variable">${CATALINA_OPTS}</span>&quot;</span>\n</code></pre></div><p><code>bitbucket _start-webapp.sh</code></p><div class="language-bash"><pre><code><span class="token assign-left variable">JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-javaagent:/var/atlassian/application-data/bitbucket/agent.jar -classpath <span class="token variable">$INST_DIR</span>/app <span class="token variable">$JAVA_OPTS</span> <span class="token variable">$BITBUCKET_ARGS</span> <span class="token variable">$JMX_OPTS</span> <span class="token variable">$JVM_REQUIRED_ARGS</span> <span class="token variable">$JVM_SUPPORT_RECOMMENDED_ARGS</span>&quot;</span>\n</code></pre></div>',61);t.render=function(a,e,t,o,c,l){return n(),s("div",null,[p])};export default t;export{e as __pageData};
